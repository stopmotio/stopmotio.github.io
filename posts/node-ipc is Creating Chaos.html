<p><i>March 23, 2022</i></p>

<p>A simple violation of trust has caused an unknown number of wiped computers for Russia and Belarus, and it all dates back to one man.</p>

<h2>How it started</h2>
<p>I'm sure we are all aware that Ukraine is being invaded by Russia, a power which formerly had control over this land. Books have been written about the historic rule of Ukraine by Russia.(<i>Red Famine</i> is a good one, but it can be hard to read. Search "Holodomor" for a quick definition.) We have all been confused and even scared as Russia confidently rushes in with the entire world watching. This lead one Brandon Miller(not doxxing, he leaves his name out in the open) to try a rather interesting approach: to take his well known, well trusted little piece of software for node.js projects that allows better multithreading, and inject a new dependency into it, called "peacenotwar". This means that all programs that use node-ipc and do not deliberately stay behind on updates will also have this code. As it turns out, at least in its original state, this "protestware" wasn't as peaceful as its demands. </p>

<p>There has been pretty understandable confusion among the chaos over whether or not any files were really deleted. The answer is that yes, there was malicious code at some point but it has since been removed, to facilitate his blatantly false claim that "[t]here was no actual code to wipe computers". In addition, not only was the original code obfuscated, meaning it was made completely unreadable by humans, but he has also taken extraordinary steps to try to erase the commit, the record of this change. Reguardless, here is <a target="_blank" href="https://gist.github.com/BrandonMiller97528/671a8bbb8da41ca34b30105db1edde1d">a deobfuscated copy that is a little easier to read</a> and <a target="_blank" href="https://github.com/RIAEvangelist/node-ipc/blob/847047cf7f81ab08352038b2204f0e7633449580/dao/ssl-geospec.js">the original commit that had this behavior</a>. He has also claimed to be swatted, and while there is no evidence and <em>I strongly discourage swatting anyone for any reason</em>, it's a fairly believable claim.</p>

<p>So here's a summary of this removed and hidden code. Essentially, there is a 50% chance that, after an aritificial delay, node-ipc will contact a server (using a key that has since been revoked) that will return what country it believes the computer running node-ipc is located in. If this returns Russia (or its neighbor Belarus for some reason) then it will overwrite all of the files in the directory. I am not sure whether this is the folder that node-ipc is in or the root folder. It will then do the same for all the files in folders in that directory, and then the folders a layer below, etc, until there is nothing left to overwrite. And what are these files being turned into? If you open them as a text file, they will read as a single heart emoji(❤️).  How cute.</p>

<p>You may have noticed a problem with the detection: If the person using the computer to be wiped is using a VPN or similar proxy making them appear within Russia/Belarus, then their computer will also be wiped reguardless of actual location. In addition, this will run on <em>any</em> computer that is running a node.js program with node-ipc. This includes embedded systems running inside ATMs, pacemakers, heart monitors, credit card scanners and other equipment. While this has extreme impacts on some civilian systems, the military impact is probably nonexistent. Military equipment is put through an extensive number of tests over multiple years to ensure that they will perform well in extreme conditions. Software updates are included in this process and all equipment runs manually reviewed versions of software, meaning node-ipc will not be able to slip through the cracks and damage any military equipment.</p>

<p>So, Brandon, I hope you're happy with yourself. I hope you know that you'll never see the end of this. I see that you wrote your own Wikipedia article in 2012 against their rules, even if others have since edited it. I don't think there is a law against such a supply chain attack, but I hope there is! This whole community will never be trusted again, Brandon, and you've set things in motion that cannot be stopped. </p>
